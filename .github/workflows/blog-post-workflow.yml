name: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –±–ª–æ–≥ –ø–æ—Å—Ç–∞–º–∏
on:
  schedule:
    # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å
    - cron: '0 * * * *'
  workflow_dispatch:

jobs:
  update-readme-with-blog:
    name: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –±–ª–æ–≥ –ø–æ—Å—Ç–∞–º–∏
    runs-on: ubuntu-latest
    steps:      
      - name: –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
        run: |
          echo "–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤..."
          # –î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–∞—à–∏—Ö —Ç–µ—Å—Ç–æ–≤ –∑–¥–µ—Å—å
          echo "–í—Å–µ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ã!"
  
  notify:
    name: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    runs-on: ubuntu-latest
    needs: update-readme-with-blog
    if: failure()
    steps:
      - name: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            üö® –í–æ—Ä–∫–ª—Ñ–æ—É '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –±–ª–æ–≥ –ø–æ—Å—Ç–∞–º–∏' –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π.
            –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ${{ github.repository }}
            –ö–æ–º–º–∏—Ç: ${{ github.sha }}
            –û—à–∏–±–∫–∞: ${{ job.status }}
            –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
  success:
    name: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏
    runs-on: ubuntu-latest
    needs: update-readme-with-blog
    if: success()
    steps:
      - name: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          message: |
            ‚úÖ –í–æ—Ä–∫–ª—Ñ–æ—É '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –±–ª–æ–≥ –ø–æ—Å—Ç–∞–º–∏' —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω.
            –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ${{ github.repository }}
            –ö–æ–º–º–∏—Ç: ${{ github.sha }}
            –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: ${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }}
  clean_up:
    name: –û—á–∏—Å—Ç–∫–∞ —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏
    runs-on: ubuntu-latest
    steps:
      - name: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        uses: actions/checkout@v2
      - name: –û—á–∏—Å—Ç–∫–∞ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        run: |
          git clean -fdx
